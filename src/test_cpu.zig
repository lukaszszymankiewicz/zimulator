const std = @import("std");
const mc = @import("mc.zig");
const cpu = @import("cpu.zig");

test "Check if `clean_reg` works" {
    var c = cpu.CPU.init();

    c.clean_reg();

    try std.testing.expect(c.get_reg_val(cpu.A) == 0);
    try std.testing.expect(c.get_reg_val(cpu.B) == 0);
    try std.testing.expect(c.get_reg_val(cpu.C) == 0);
    try std.testing.expect(c.get_reg_val(cpu.D) == 0);
    try std.testing.expect(c.get_reg_val(cpu.E) == 0);
    try std.testing.expect(c.get_reg_val(cpu.H) == 0);
    try std.testing.expect(c.get_reg_val(cpu.L) == 0);
    try std.testing.expect(c.get_reg_val(cpu.BC) == 0);
    try std.testing.expect(c.get_reg_val(cpu.DE) == 0);
    try std.testing.expect(c.get_reg_val(cpu.HL) == 0);
}

pub const INIT = 0;
pub const EXP = 1;
pub const IMM0 = 0;
pub const IMM1 = 1;
pub const ADDRESS = 0;
pub const VAL = 1;

const CASE = struct {
    OP: u32 = 0,
    A: [2]u32 = .{ 0, 0 },
    B: [2]u32 = .{ 0, 0 },
    C: [2]u32 = .{ 0, 0 },
    D: [2]u32 = .{ 0, 0 },
    E: [2]u32 = .{ 0, 0 },
    H: [2]u32 = .{ 0, 0 },
    L: [2]u32 = .{ 0, 0 },
    CF: [2]u32 = .{ 0, 0 },
    HF: [2]u32 = .{ 0, 0 },
    NF: [2]u32 = .{ 0, 0 },
    ZF: [2]u32 = .{ 0, 0 },
    S: [2]u32 = .{ 0, 0 },
    P: [2]u32 = .{ 0, 0 },
    MEM: [2]u32 = .{ 0, 0 },
    EXP_MEM: [2]u32 = .{ 0, 0 },
    IMM: [2]u32 = .{ 0, 0 },
};

test "new approach" {
    const test_cases = [_]CASE{
        .{ .OP = cpu.NOP },
        .{ .OP = cpu.NOP },
        .{ .OP = cpu.NOP },
        // ADD
        .{ .OP = cpu.ADD_A_B, .A = .{ 0b1111_1111, 0b0000_0000 }, .B = .{ 0b0000_0001, 0b0000_0001 }, .CF = .{ 0, 1 }, .HF = .{ 0, 1 }, .NF = .{ 0, 0 }, .ZF = .{ 0, 1 } },
        .{ .OP = cpu.ADD_A_B, .A = .{ 0b1111_1111, 0b0000_1000 }, .B = .{ 0b0000_1001, 0b0000_1001 }, .CF = .{ 0, 1 }, .HF = .{ 0, 1 }, .NF = .{ 0, 0 }, .ZF = .{ 0, 0 } },
        .{ .OP = cpu.ADD_A_B, .A = .{ 0b0100_0001, 0b0111_0000 }, .B = .{ 0b0010_1111, 0b0010_1111 }, .CF = .{ 0, 0 }, .HF = .{ 0, 1 }, .NF = .{ 0, 0 }, .ZF = .{ 0, 0 } },
        .{ .OP = cpu.ADD_A_C, .A = .{ 0b0000_0000, 0b0000_0000 }, .C = .{ 0, 0 }, .CF = .{ 0, 0 }, .HF = .{ 0, 0 }, .NF = .{ 0, 0 }, .ZF = .{ 0, 1 } },
        .{ .OP = cpu.ADD_A_C, .A = .{ 0b1111_0001, 0b0001_0000 }, .C = .{ 0b0001_1111, 0b0001_1111 }, .CF = .{ 0, 1 }, .HF = .{ 0, 0 }, .NF = .{ 0, 0 }, .ZF = .{ 0, 0 } },
        .{ .OP = cpu.ADD_A_D, .A = .{ 0b0000_0001, 0b0000_0011 }, .D = .{ 0b0000_0010, 0b0000_0010 }, .CF = .{ 0, 0 }, .HF = .{ 0, 0 }, .NF = .{ 0, 0 }, .ZF = .{ 0, 0 } },
        .{ .OP = cpu.ADD_A_D, .A = .{ 0b1111_1111, 0b1111_1110 }, .D = .{ 0b1111_1111, 0b1111_1111 }, .CF = .{ 0, 1 }, .HF = .{ 0, 0 }, .NF = .{ 0, 0 }, .ZF = .{ 0, 0 } },
        .{ .OP = cpu.ADD_A_E, .A = .{ 0b0000_1001, 0b0000_1011 }, .E = .{ 0b0000_0010, 0b0000_0010 }, .CF = .{ 0, 0 }, .HF = .{ 0, 0 }, .NF = .{ 0, 0 }, .ZF = .{ 0, 0 } },
        .{ .OP = cpu.ADD_A_H, .A = .{ 0b0000_0001, 0b0001_0000 }, .H = .{ 0b0000_1111, 0b0000_1111 }, .CF = .{ 0, 0 }, .HF = .{ 0, 1 }, .NF = .{ 0, 0 }, .ZF = .{ 0, 0 } },
        .{ .OP = cpu.ADD_A_L, .A = .{ 0b0000_0001, 0b0001_0000 }, .L = .{ 0b0000_1111, 0b0000_1111 }, .CF = .{ 0, 0 }, .HF = .{ 0, 1 }, .NF = .{ 0, 0 }, .ZF = .{ 0, 0 } },
        .{ .OP = cpu.ADD_A_A, .A = .{ 0b0000_0001, 0b0000_0010 }, .CF = .{ 0, 0 }, .HF = .{ 0, 0 }, .NF = .{ 0, 0 }, .ZF = .{ 0, 0 } },
        .{ .OP = cpu.ADD_A_A, .A = .{ 0b0000_0011, 0b0000_0110 }, .CF = .{ 0, 0 }, .HF = .{ 0, 0 }, .NF = .{ 0, 0 }, .ZF = .{ 0, 0 } },
        .{ .OP = cpu.ADD_A_A, .A = .{ 0b0001_0101, 0b0010_1010 }, .CF = .{ 0, 0 }, .HF = .{ 0, 1 }, .NF = .{ 0, 0 }, .ZF = .{ 0, 0 } },
        // SUB
        .{ .OP = cpu.SUB_B, .A = .{ 0b0000_0111, 0b1111_1000 }, .B = .{ 0b0000_1111, 0b0000_1111 }, .CF = .{ 0, 1 }, .HF = .{ 0, 1 }, .NF = .{ 0, 1 }, .ZF = .{ 0, 0 } },
        .{ .OP = cpu.SUB_B, .A = .{ 0b0001_0101, 0b0001_0100 }, .B = .{ 0b0000_0001, 0b0000_0001 }, .CF = .{ 0, 0 }, .HF = .{ 0, 0 }, .NF = .{ 0, 1 }, .ZF = .{ 0, 0 } },
        .{ .OP = cpu.SUB_B, .A = .{ 0b0000_0000, 0b0000_0000 }, .B = .{ 0b0000_0000, 0b0000_0000 }, .CF = .{ 0, 0 }, .HF = .{ 0, 0 }, .NF = .{ 0, 1 }, .ZF = .{ 0, 1 } },
        .{ .OP = cpu.SUB_C, .A = .{ 0b0001_0101, 0b0000_0000 }, .C = .{ 0b0001_0101, 0b0001_0101 }, .CF = .{ 0, 0 }, .HF = .{ 0, 1 }, .NF = .{ 0, 1 }, .ZF = .{ 0, 1 } },
        .{ .OP = cpu.SUB_D, .A = .{ 0b0111_1111, 0b0010_1010 }, .D = .{ 0b0101_0101, 0b0101_0101 }, .CF = .{ 0, 0 }, .HF = .{ 0, 1 }, .NF = .{ 0, 1 }, .ZF = .{ 0, 0 } },
        .{ .OP = cpu.SUB_E, .A = .{ 0b0111_1111, 0b0010_1010 }, .E = .{ 0b0101_0101, 0b0101_0101 }, .CF = .{ 0, 0 }, .HF = .{ 0, 1 }, .NF = .{ 0, 1 }, .ZF = .{ 0, 0 } },
        .{ .OP = cpu.SUB_H, .A = .{ 0b0111_1111, 0b0010_1010 }, .H = .{ 0b0101_0101, 0b0101_0101 }, .CF = .{ 0, 0 }, .HF = .{ 0, 1 }, .NF = .{ 0, 1 }, .ZF = .{ 0, 0 } },
        .{ .OP = cpu.SUB_L, .A = .{ 0b0000_0000, 0b1111_1111 }, .L = .{ 0b0000_0001, 0b0000_0001 }, .CF = .{ 0, 1 }, .HF = .{ 0, 1 }, .NF = .{ 0, 1 }, .ZF = .{ 0, 0 } },
        .{ .OP = cpu.SUB_A, .A = .{ 0b0000_0000, 0b0000_0000 }, .NF = .{ 0, 1 }, .ZF = .{ 0, 1 } },
        .{ .OP = cpu.SUB_A, .A = .{ 0b0000_0001, 0b0000_0000 }, .NF = .{ 0, 1 }, .ZF = .{ 0, 1 } },
        .{ .OP = cpu.SUB_A, .A = .{ 0b0000_1111, 0b0000_0000 }, .NF = .{ 0, 1 }, .ZF = .{ 0, 1 } },
        .{ .OP = cpu.SUB_A, .A = .{ 0b1000_1000, 0b0000_0000 }, .NF = .{ 0, 1 }, .ZF = .{ 0, 1 } },
        .{ .OP = cpu.SUB_A, .A = .{ 0b1111_1111, 0b0000_0000 }, .NF = .{ 0, 1 }, .ZF = .{ 0, 1 }, .HF = .{ 0, 1 } },
        // ADC
        .{ .OP = cpu.ADC_A_B, .A = .{ 0b1111_1111, 0b0000_0001 }, .B = .{ 0b0000_0001, 0b0000_0001 }, .CF = .{ 1, 1 }, .HF = .{ 0, 1 }, .NF = .{ 0, 0 }, .ZF = .{ 0, 0 } },
        .{ .OP = cpu.ADC_A_B, .A = .{ 0b0100_0001, 0b0111_0001 }, .B = .{ 0b0010_1111, 0b0010_1111 }, .CF = .{ 1, 0 }, .HF = .{ 0, 1 }, .NF = .{ 0, 0 }, .ZF = .{ 0, 0 } },
        .{ .OP = cpu.ADC_A_C, .A = .{ 0b0000_0000, 0b0000_0000 }, .C = .{ 0b0000_0000, 0b0000_0000 }, .CF = .{ 0, 0 }, .HF = .{ 0, 0 }, .NF = .{ 0, 0 }, .ZF = .{ 0, 1 } },
        .{ .OP = cpu.ADC_A_C, .A = .{ 0b1111_0001, 0b0001_0000 }, .C = .{ 0b0001_1111, 0b0001_1111 }, .CF = .{ 0, 1 }, .HF = .{ 0, 0 }, .NF = .{ 0, 0 }, .ZF = .{ 0, 0 } },
        .{ .OP = cpu.ADC_A_D, .A = .{ 0b0000_0001, 0b0000_0100 }, .D = .{ 0b0000_0010, 0b0000_0010 }, .CF = .{ 1, 0 }, .HF = .{ 0, 0 }, .NF = .{ 0, 0 }, .ZF = .{ 0, 0 } },
        .{ .OP = cpu.ADC_A_D, .A = .{ 0b1111_1111, 0b1111_1111 }, .D = .{ 0b1111_1111, 0b1111_1111 }, .CF = .{ 1, 1 }, .HF = .{ 0, 0 }, .NF = .{ 0, 0 }, .ZF = .{ 0, 0 } },
        .{ .OP = cpu.ADC_A_E, .A = .{ 0b0000_1001, 0b0000_1011 }, .E = .{ 0b0000_0010, 0b0000_0010 }, .CF = .{ 0, 0 }, .HF = .{ 0, 0 }, .NF = .{ 0, 0 }, .ZF = .{ 0, 0 } },
        .{ .OP = cpu.ADC_A_H, .A = .{ 0b0000_0001, 0b0001_0001 }, .H = .{ 0b0000_1111, 0b0000_1111 }, .CF = .{ 1, 0 }, .HF = .{ 0, 1 }, .NF = .{ 0, 0 }, .ZF = .{ 0, 0 } },
        .{ .OP = cpu.ADC_A_L, .A = .{ 0b0000_0001, 0b0001_0000 }, .L = .{ 0b0000_1111, 0b0000_1111 }, .CF = .{ 0, 0 }, .HF = .{ 0, 1 }, .NF = .{ 0, 0 }, .ZF = .{ 0, 0 } },
        .{ .OP = cpu.ADC_A_A, .A = .{ 0b0000_0001, 0b0000_0010 }, .CF = .{ 0, 0 }, .HF = .{ 0, 0 }, .NF = .{ 0, 0 }, .ZF = .{ 0, 0 } },
        .{ .OP = cpu.ADC_A_A, .A = .{ 0b0000_0011, 0b0000_0111 }, .CF = .{ 1, 0 }, .HF = .{ 0, 0 }, .NF = .{ 0, 0 }, .ZF = .{ 0, 0 } },
        .{ .OP = cpu.ADC_A_A, .A = .{ 0b0001_0101, 0b0010_1010 }, .CF = .{ 0, 0 }, .HF = .{ 0, 1 }, .NF = .{ 0, 0 }, .ZF = .{ 0, 0 } },
        // LD_HLPLUS_A
        .{ .OP = cpu.LD_HLPLUS_A, .A = .{ 13, 13 }, .H = .{ 10, 10 }, .L = .{ 10, 11 }, .EXP_MEM = .{ 2750, 12 } },
        .{ .OP = cpu.LD_HLPLUS_A, .A = .{ 13, 13 }, .H = .{ 10, 10 }, .L = .{ 10, 11 }, .EXP_MEM = .{ 2570, 13 } },
        .{ .OP = cpu.LD_HLPLUS_A, .A = .{ 0, 0 }, .H = .{ 0, 0 }, .L = .{ 0, 1 }, .EXP_MEM = .{ 0, 0 } },
        .{ .OP = cpu.LD_HLPLUS_A, .A = .{ 255, 255 }, .H = .{ 1, 1 }, .L = .{ 0, 1 }, .EXP_MEM = .{ 256, 255 } },
        .{ .OP = cpu.LD_HLPLUS_A, .A = .{ 42, 42 }, .H = .{ 0, 0 }, .L = .{ 100, 101 }, .EXP_MEM = .{ 100, 42 } },
        .{ .OP = cpu.LD_HLPLUS_A, .A = .{ 128, 128 }, .H = .{ 2, 2 }, .L = .{ 50, 51 }, .EXP_MEM = .{ 562, 128 } },
        .{ .OP = cpu.LD_HLPLUS_A, .A = .{ 85, 85 }, .H = .{ 1, 2 }, .L = .{ 255, 0 }, .EXP_MEM = .{ 511, 85 } },
        .{ .OP = cpu.LD_HLPLUS_A, .A = .{ 200, 200 }, .H = .{ 5, 5 }, .L = .{ 254, 255 }, .EXP_MEM = .{ 1534, 200 } },
        .{ .OP = cpu.LD_HLPLUS_A, .A = .{ 77, 77 }, .H = .{ 255, 0 }, .L = .{ 255, 0 }, .EXP_MEM = .{ 65535, 77 } },
        .{ .OP = cpu.LD_HLPLUS_A, .A = .{ 33, 33 }, .H = .{ 10, 10 }, .L = .{ 20, 21 }, .EXP_MEM = .{ 2580, 33 } },
        .{ .OP = cpu.LD_HLPLUS_A, .A = .{ 170, 170 }, .H = .{ 50, 50 }, .L = .{ 200, 201 }, .EXP_MEM = .{ 13000, 170 } },
        .{ .OP = cpu.LD_HLPLUS_A, .A = .{ 99, 99 }, .H = .{ 100, 100 }, .L = .{ 150, 151 }, .EXP_MEM = .{ 25750, 99 } },
        .{ .OP = cpu.LD_HLPLUS_A, .A = .{ 1, 1 }, .H = .{ 254, 255 }, .L = .{ 255, 0 }, .EXP_MEM = .{ 65279, 1 } },
        // LD_HLMINUS_A
        .{ .OP = cpu.LD_HLMINUS_A, .A = .{ 13, 13 }, .H = .{ 10, 10 }, .L = .{ 10, 9 }, .EXP_MEM = .{ 2570, 13 } },
        .{ .OP = cpu.LD_HLMINUS_A, .A = .{ 0, 0 }, .H = .{ 0, 0 }, .L = .{ 1, 0 }, .EXP_MEM = .{ 1, 0 } },
        .{ .OP = cpu.LD_HLMINUS_A, .A = .{ 255, 255 }, .H = .{ 1, 0 }, .L = .{ 0, 255 }, .EXP_MEM = .{ 256, 255 } },
        .{ .OP = cpu.LD_HLMINUS_A, .A = .{ 42, 42 }, .H = .{ 0, 0 }, .L = .{ 100, 99 }, .EXP_MEM = .{ 100, 42 } },
        .{ .OP = cpu.LD_HLMINUS_A, .A = .{ 128, 128 }, .H = .{ 2, 2 }, .L = .{ 50, 49 }, .EXP_MEM = .{ 562, 128 } },
        .{ .OP = cpu.LD_HLMINUS_A, .A = .{ 85, 85 }, .H = .{ 2, 1 }, .L = .{ 0, 255 }, .EXP_MEM = .{ 512, 85 } },
        .{ .OP = cpu.LD_HLMINUS_A, .A = .{ 200, 200 }, .H = .{ 5, 5 }, .L = .{ 1, 0 }, .EXP_MEM = .{ 1281, 200 } },
        .{ .OP = cpu.LD_HLMINUS_A, .A = .{ 77, 77 }, .H = .{ 0, 255 }, .L = .{ 0, 255 }, .EXP_MEM = .{ 0, 77 } },
        .{ .OP = cpu.LD_HLMINUS_A, .A = .{ 33, 33 }, .H = .{ 10, 10 }, .L = .{ 20, 19 }, .EXP_MEM = .{ 2580, 33 } },
        .{ .OP = cpu.LD_HLMINUS_A, .A = .{ 170, 170 }, .H = .{ 50, 50 }, .L = .{ 200, 199 }, .EXP_MEM = .{ 13000, 170 } },
        .{ .OP = cpu.LD_HLMINUS_A, .A = .{ 99, 99 }, .H = .{ 100, 100 }, .L = .{ 150, 149 }, .EXP_MEM = .{ 25750, 99 } },
        .{ .OP = cpu.LD_HLMINUS_A, .A = .{ 1, 1 }, .H = .{ 1, 0 }, .L = .{ 0, 255 }, .EXP_MEM = .{ 256, 1 } },
        .{ .OP = cpu.LD_HLMINUS_A, .A = .{ 64, 64 }, .H = .{ 255, 254 }, .L = .{ 0, 255 }, .EXP_MEM = .{ 65280, 64 } },
        .{ .OP = cpu.LD_HLMINUS_A, .A = .{ 13, 13 }, .H = .{ 10, 10 }, .L = .{ 10, 9 }, .EXP_MEM = .{ 2570, 13 } },
        // ADD_A_HL
        .{ .OP = cpu.ADD_A_HL, .A = .{ 1, 100 }, .H = .{ 1, 1 }, .L = .{ 9, 9 }, .CF = .{ 0, 0 }, .HF = .{ 1, 0 }, .NF = .{ 0, 0 }, .ZF = .{ 0, 0 }, .MEM = .{ 265, 99 } },
        .{ .OP = cpu.ADD_A_HL, .A = .{ 255, 0 }, .H = .{ 2, 2 }, .L = .{ 0, 0 }, .CF = .{ 0, 1 }, .HF = .{ 0, 1 }, .NF = .{ 0, 0 }, .ZF = .{ 0, 1 }, .MEM = .{ 512, 1 } },
        .{ .OP = cpu.ADD_A_HL, .A = .{ 15, 16 }, .H = .{ 1, 1 }, .L = .{ 0, 0 }, .CF = .{ 0, 0 }, .HF = .{ 0, 1 }, .NF = .{ 0, 0 }, .ZF = .{ 0, 0 }, .MEM = .{ 256, 1 } },
        .{ .OP = cpu.ADD_A_HL, .A = .{ 0, 0 }, .H = .{ 3, 3 }, .L = .{ 0, 0 }, .CF = .{ 0, 0 }, .HF = .{ 0, 0 }, .NF = .{ 0, 0 }, .ZF = .{ 0, 1 }, .MEM = .{ 768, 0 } },
        .{ .OP = cpu.ADD_A_HL, .A = .{ 50, 75 }, .H = .{ 1, 1 }, .L = .{ 100, 100 }, .CF = .{ 0, 0 }, .HF = .{ 0, 1 }, .NF = .{ 0, 0 }, .ZF = .{ 0, 0 }, .MEM = .{ 356, 25 } },
        .{ .OP = cpu.ADD_A_HL, .A = .{ 100, 99 }, .H = .{ 4, 4 }, .L = .{ 0, 0 }, .CF = .{ 0, 1 }, .HF = .{ 0, 0 }, .NF = .{ 0, 0 }, .ZF = .{ 0, 0 }, .MEM = .{ 1024, 255 } },
        .{ .OP = cpu.ADD_A_HL, .A = .{ 255, 254 }, .H = .{ 5, 5 }, .L = .{ 0, 0 }, .CF = .{ 0, 1 }, .HF = .{ 0, 0 }, .NF = .{ 0, 0 }, .ZF = .{ 0, 0 }, .MEM = .{ 1280, 255 } },
        .{ .OP = cpu.ADD_A_HL, .A = .{ 240, 0 }, .H = .{ 6, 6 }, .L = .{ 0, 0 }, .CF = .{ 0, 1 }, .HF = .{ 0, 1 }, .NF = .{ 0, 0 }, .ZF = .{ 0, 1 }, .MEM = .{ 1536, 16 } },
        .{ .OP = cpu.ADD_A_HL, .A = .{ 8, 16 }, .H = .{ 7, 7 }, .L = .{ 0, 0 }, .CF = .{ 0, 0 }, .HF = .{ 0, 1 }, .NF = .{ 0, 0 }, .ZF = .{ 0, 0 }, .MEM = .{ 1792, 8 } },
        .{ .OP = cpu.ADD_A_HL, .A = .{ 10, 15 }, .H = .{ 8, 8 }, .L = .{ 0, 0 }, .CF = .{ 0, 0 }, .HF = .{ 0, 0 }, .NF = .{ 0, 0 }, .ZF = .{ 0, 0 }, .MEM = .{ 2048, 5 } },
        // ADC
        .{ .OP = cpu.ADC_A_HL, .A = .{ 1, 101 }, .H = .{ 1, 1 }, .L = .{ 9, 9 }, .CF = .{ 1, 0 }, .HF = .{ 0, 0 }, .NF = .{ 0, 0 }, .ZF = .{ 0, 0 }, .MEM = .{ 265, 99 } },
        .{ .OP = cpu.ADC_A_HL, .A = .{ 255, 1 }, .H = .{ 2, 2 }, .L = .{ 0, 0 }, .CF = .{ 1, 1 }, .HF = .{ 0, 1 }, .NF = .{ 0, 0 }, .ZF = .{ 0, 0 }, .MEM = .{ 512, 1 } },
        .{ .OP = cpu.ADC_A_HL, .A = .{ 15, 17 }, .H = .{ 1, 1 }, .L = .{ 0, 0 }, .CF = .{ 1, 0 }, .HF = .{ 0, 1 }, .NF = .{ 0, 0 }, .ZF = .{ 0, 0 }, .MEM = .{ 256, 1 } },
        .{ .OP = cpu.ADC_A_HL, .A = .{ 0, 1 }, .H = .{ 3, 3 }, .L = .{ 0, 0 }, .CF = .{ 1, 0 }, .HF = .{ 0, 0 }, .NF = .{ 0, 0 }, .ZF = .{ 0, 0 }, .MEM = .{ 768, 0 } },
        .{ .OP = cpu.ADC_A_HL, .A = .{ 50, 76 }, .H = .{ 1, 1 }, .L = .{ 100, 100 }, .CF = .{ 1, 0 }, .HF = .{ 0, 1 }, .NF = .{ 0, 0 }, .ZF = .{ 0, 0 }, .MEM = .{ 356, 25 } },
        .{ .OP = cpu.ADC_A_HL, .A = .{ 100, 99 }, .H = .{ 4, 4 }, .L = .{ 0, 0 }, .CF = .{ 0, 1 }, .HF = .{ 0, 0 }, .NF = .{ 0, 0 }, .ZF = .{ 0, 0 }, .MEM = .{ 1024, 255 } },
        .{ .OP = cpu.ADC_A_HL, .A = .{ 255, 254 }, .H = .{ 5, 5 }, .L = .{ 0, 0 }, .CF = .{ 0, 1 }, .HF = .{ 0, 0 }, .NF = .{ 0, 0 }, .ZF = .{ 0, 0 }, .MEM = .{ 1280, 255 } },
        .{ .OP = cpu.ADC_A_HL, .A = .{ 240, 0 }, .H = .{ 6, 6 }, .L = .{ 0, 0 }, .CF = .{ 0, 1 }, .HF = .{ 0, 1 }, .NF = .{ 0, 0 }, .ZF = .{ 0, 1 }, .MEM = .{ 1536, 16 } },
        .{ .OP = cpu.ADC_A_HL, .A = .{ 8, 16 }, .H = .{ 7, 7 }, .L = .{ 0, 0 }, .CF = .{ 0, 0 }, .HF = .{ 0, 1 }, .NF = .{ 0, 0 }, .ZF = .{ 0, 0 }, .MEM = .{ 1792, 8 } },
        .{ .OP = cpu.ADC_A_HL, .A = .{ 10, 15 }, .H = .{ 8, 8 }, .L = .{ 0, 0 }, .CF = .{ 0, 0 }, .HF = .{ 0, 0 }, .NF = .{ 0, 0 }, .ZF = .{ 0, 0 }, .MEM = .{ 2048, 5 } },
        // SUB
        .{ .OP = cpu.SUB_HL, .A = .{ 21, 20 }, .H = .{ 1, 1 }, .L = .{ 9, 9 }, .CF = .{ 0, 0 }, .HF = .{ 0, 0 }, .NF = .{ 0, 1 }, .ZF = .{ 0, 0 }, .MEM = .{ 265, 1 } },
        .{ .OP = cpu.SUB_HL, .A = .{ 21, 0 }, .H = .{ 2, 2 }, .L = .{ 0, 0 }, .CF = .{ 0, 0 }, .HF = .{ 0, 1 }, .NF = .{ 0, 1 }, .ZF = .{ 0, 1 }, .MEM = .{ 512, 21 } },
        .{ .OP = cpu.SUB_HL, .A = .{ 127, 42 }, .H = .{ 3, 3 }, .L = .{ 0, 0 }, .CF = .{ 0, 0 }, .HF = .{ 0, 1 }, .NF = .{ 0, 1 }, .ZF = .{ 0, 0 }, .MEM = .{ 768, 85 } },
        .{ .OP = cpu.SUB_HL, .A = .{ 127, 42 }, .H = .{ 1, 1 }, .L = .{ 0, 0 }, .CF = .{ 0, 0 }, .HF = .{ 0, 1 }, .NF = .{ 0, 1 }, .ZF = .{ 0, 0 }, .MEM = .{ 256, 85 } },
        .{ .OP = cpu.SUB_HL, .A = .{ 127, 42 }, .H = .{ 4, 4 }, .L = .{ 0, 0 }, .CF = .{ 0, 0 }, .HF = .{ 0, 1 }, .NF = .{ 0, 1 }, .ZF = .{ 0, 0 }, .MEM = .{ 1024, 85 } },
        .{ .OP = cpu.SUB_HL, .A = .{ 0, 255 }, .H = .{ 5, 5 }, .L = .{ 0, 0 }, .CF = .{ 0, 1 }, .HF = .{ 0, 1 }, .NF = .{ 0, 1 }, .ZF = .{ 0, 0 }, .MEM = .{ 1280, 1 } },
        .{ .OP = cpu.SUB_HL, .A = .{ 0, 0 }, .H = .{ 6, 6 }, .L = .{ 0, 0 }, .CF = .{ 0, 0 }, .HF = .{ 0, 0 }, .NF = .{ 0, 1 }, .ZF = .{ 0, 1 }, .MEM = .{ 1536, 0 } },
        .{ .OP = cpu.SUB_HL, .A = .{ 1, 1 }, .H = .{ 7, 7 }, .L = .{ 0, 0 }, .CF = .{ 0, 0 }, .HF = .{ 0, 0 }, .NF = .{ 0, 1 }, .ZF = .{ 0, 0 }, .MEM = .{ 1792, 0 } },
        .{ .OP = cpu.SUB_HL, .A = .{ 15, 15 }, .H = .{ 8, 8 }, .L = .{ 0, 0 }, .CF = .{ 0, 0 }, .HF = .{ 0, 0 }, .NF = .{ 0, 1 }, .ZF = .{ 0, 0 }, .MEM = .{ 2048, 0 } },
        .{ .OP = cpu.SUB_HL, .A = .{ 136, 0 }, .H = .{ 9, 9 }, .L = .{ 0, 0 }, .CF = .{ 0, 0 }, .HF = .{ 0, 0 }, .NF = .{ 0, 1 }, .ZF = .{ 0, 1 }, .MEM = .{ 2304, 136 } },
        .{ .OP = cpu.SUB_HL, .A = .{ 255, 0 }, .H = .{ 10, 10 }, .L = .{ 0, 0 }, .CF = .{ 0, 0 }, .HF = .{ 0, 1 }, .NF = .{ 0, 1 }, .ZF = .{ 0, 1 }, .MEM = .{ 2560, 255 } },
        // LD_BC_A
        .{ .OP = cpu.LD_BC_A, .A = .{ 13, 13 }, .B = .{ 10, 10 }, .C = .{ 10, 10 }, .EXP_MEM = .{ 2570, 13 } },
        .{ .OP = cpu.LD_BC_A, .A = .{ 13, 13 }, .B = .{ 10, 10 }, .C = .{ 10, 10 }, .EXP_MEM = .{ 2570, 13 } },
        .{ .OP = cpu.LD_BC_A, .A = .{ 0, 0 }, .B = .{ 0, 0 }, .C = .{ 0, 0 }, .EXP_MEM = .{ 0, 0 } },
        .{ .OP = cpu.LD_BC_A, .A = .{ 255, 255 }, .B = .{ 0, 0 }, .C = .{ 1, 1 }, .EXP_MEM = .{ 1, 255 } },
        .{ .OP = cpu.LD_BC_A, .A = .{ 42, 42 }, .B = .{ 1, 1 }, .C = .{ 0, 0 }, .EXP_MEM = .{ 256, 42 } },
        .{ .OP = cpu.LD_BC_A, .A = .{ 128, 128 }, .B = .{ 1, 1 }, .C = .{ 1, 1 }, .EXP_MEM = .{ 257, 128 } },
        .{ .OP = cpu.LD_BC_A, .A = .{ 85, 85 }, .B = .{ 2, 2 }, .C = .{ 50, 50 }, .EXP_MEM = .{ 562, 85 } },
        .{ .OP = cpu.LD_BC_A, .A = .{ 200, 200 }, .B = .{ 3, 3 }, .C = .{ 100, 100 }, .EXP_MEM = .{ 868, 200 } },
        .{ .OP = cpu.LD_BC_A, .A = .{ 1, 1 }, .B = .{ 10, 10 }, .C = .{ 20, 20 }, .EXP_MEM = .{ 2580, 1 } },
        .{ .OP = cpu.LD_BC_A, .A = .{ 170, 170 }, .B = .{ 5, 5 }, .C = .{ 170, 170 }, .EXP_MEM = .{ 1450, 170 } },
        .{ .OP = cpu.LD_BC_A, .A = .{ 99, 99 }, .B = .{ 15, 15 }, .C = .{ 240, 240 }, .EXP_MEM = .{ 4080, 99 } },
        .{ .OP = cpu.LD_BC_A, .A = .{ 33, 33 }, .B = .{ 100, 100 }, .C = .{ 50, 50 }, .EXP_MEM = .{ 25650, 33 } },
        .{ .OP = cpu.LD_BC_A, .A = .{ 77, 77 }, .B = .{ 255, 255 }, .C = .{ 255, 255 }, .EXP_MEM = .{ 65535, 77 } },
        // LD_DE_A
        .{ .OP = cpu.LD_DE_A, .A = .{ 13, 13 }, .D = .{ 10, 10 }, .E = .{ 10, 10 }, .EXP_MEM = .{ 2570, 13 } },
        .{ .OP = cpu.LD_DE_A, .A = .{ 13, 13 }, .D = .{ 10, 10 }, .E = .{ 10, 10 }, .EXP_MEM = .{ 2570, 13 } },
        .{ .OP = cpu.LD_DE_A, .A = .{ 0, 0 }, .D = .{ 0, 0 }, .E = .{ 0, 0 }, .EXP_MEM = .{ 0, 0 } },
        .{ .OP = cpu.LD_DE_A, .A = .{ 255, 255 }, .D = .{ 0, 0 }, .E = .{ 1, 1 }, .EXP_MEM = .{ 1, 255 } },
        .{ .OP = cpu.LD_DE_A, .A = .{ 42, 42 }, .D = .{ 1, 1 }, .E = .{ 0, 0 }, .EXP_MEM = .{ 256, 42 } },
        .{ .OP = cpu.LD_DE_A, .A = .{ 128, 128 }, .D = .{ 1, 1 }, .E = .{ 1, 1 }, .EXP_MEM = .{ 257, 128 } },
        .{ .OP = cpu.LD_DE_A, .A = .{ 85, 85 }, .D = .{ 2, 2 }, .E = .{ 50, 50 }, .EXP_MEM = .{ 562, 85 } },
        .{ .OP = cpu.LD_DE_A, .A = .{ 200, 200 }, .D = .{ 3, 3 }, .E = .{ 100, 100 }, .EXP_MEM = .{ 868, 200 } },
        .{ .OP = cpu.LD_DE_A, .A = .{ 1, 1 }, .D = .{ 10, 10 }, .E = .{ 20, 20 }, .EXP_MEM = .{ 2580, 1 } },
        .{ .OP = cpu.LD_DE_A, .A = .{ 170, 170 }, .D = .{ 5, 5 }, .E = .{ 170, 170 }, .EXP_MEM = .{ 1450, 170 } },
        .{ .OP = cpu.LD_DE_A, .A = .{ 99, 99 }, .D = .{ 15, 15 }, .E = .{ 240, 240 }, .EXP_MEM = .{ 4080, 99 } },
        .{ .OP = cpu.LD_DE_A, .A = .{ 33, 33 }, .D = .{ 100, 100 }, .E = .{ 50, 50 }, .EXP_MEM = .{ 25650, 33 } },
        .{ .OP = cpu.LD_DE_A, .A = .{ 77, 77 }, .D = .{ 255, 255 }, .E = .{ 255, 255 }, .EXP_MEM = .{ 65535, 77 } },
        // LD_BC_D16
        .{ .OP = cpu.LD_BC_D16, .IMM = .{ 0b00000000, 0b00000000 }, .B = .{ 0b00000000, 0b00000000 }, .C = .{ 0b00000000, 0b00000000 } },
        .{ .OP = cpu.LD_BC_D16, .IMM = .{ 0b00000000, 0b10000000 }, .B = .{ 0b00000000, 0b00000000 }, .C = .{ 0b10000000, 0b10000000 } },
        .{ .OP = cpu.LD_BC_D16, .IMM = .{ 0b00000000, 0b11111111 }, .B = .{ 0b00000000, 0b00000000 }, .C = .{ 0b11111111, 0b11111111 } },
        .{ .OP = cpu.LD_BC_D16, .IMM = .{ 0b00000001, 0b00000001 }, .B = .{ 0b00000001, 0b00000001 }, .C = .{ 0b00000001, 0b00000001 } },
        .{ .OP = cpu.LD_BC_D16, .IMM = .{ 0b00001111, 0b11110000 }, .B = .{ 0b00001111, 0b00001111 }, .C = .{ 0b11110000, 0b11110000 } },
        .{ .OP = cpu.LD_BC_D16, .IMM = .{ 0b00110100, 0b00010010 }, .B = .{ 0b00110100, 0b00110100 }, .C = .{ 0b00010010, 0b00010010 } },
        .{ .OP = cpu.LD_BC_D16, .IMM = .{ 0b01000010, 0b01101001 }, .B = .{ 0b01000010, 0b01000010 }, .C = .{ 0b01101001, 0b01101001 } },
        .{ .OP = cpu.LD_BC_D16, .IMM = .{ 0b01010101, 0b10101010 }, .B = .{ 0b01010101, 0b01010101 }, .C = .{ 0b10101010, 0b10101010 } },
        .{ .OP = cpu.LD_BC_D16, .IMM = .{ 0b01111111, 0b11111111 }, .B = .{ 0b01111111, 0b01111111 }, .C = .{ 0b11111111, 0b11111111 } },
        .{ .OP = cpu.LD_BC_D16, .IMM = .{ 0b10000000, 0b00000000 }, .B = .{ 0b10000000, 0b10000000 }, .C = .{ 0b00000000, 0b00000000 } },
        .{ .OP = cpu.LD_BC_D16, .IMM = .{ 0b10101010, 0b01010101 }, .B = .{ 0b10101010, 0b10101010 }, .C = .{ 0b01010101, 0b01010101 } },
        .{ .OP = cpu.LD_BC_D16, .IMM = .{ 0b11110000, 0b00001111 }, .B = .{ 0b11110000, 0b11110000 }, .C = .{ 0b00001111, 0b00001111 } },
        .{ .OP = cpu.LD_BC_D16, .IMM = .{ 0b11111111, 0b00000000 }, .B = .{ 0b11111111, 0b11111111 }, .C = .{ 0b00000000, 0b00000000 } },
        .{ .OP = cpu.LD_BC_D16, .IMM = .{ 0b11111111, 0b11111111 }, .B = .{ 0b11111111, 0b11111111 }, .C = .{ 0b11111111, 0b11111111 } },
        .{ .OP = cpu.LD_DE_D16, .IMM = .{ 0b00000000, 0b00000000 }, .D = .{ 0b00000000, 0b00000000 }, .E = .{ 0b00000000, 0b00000000 } },
        .{ .OP = cpu.LD_DE_D16, .IMM = .{ 0b00000001, 0b00000001 }, .D = .{ 0b00000001, 0b00000001 }, .E = .{ 0b00000001, 0b00000001 } },
        .{ .OP = cpu.LD_DE_D16, .IMM = .{ 0b00110100, 0b00010010 }, .D = .{ 0b00110100, 0b00110100 }, .E = .{ 0b00010010, 0b00010010 } },
        .{ .OP = cpu.LD_DE_D16, .IMM = .{ 0b10101010, 0b01010101 }, .D = .{ 0b10101010, 0b10101010 }, .E = .{ 0b01010101, 0b01010101 } },
        .{ .OP = cpu.LD_DE_D16, .IMM = .{ 0b11111111, 0b11111111 }, .D = .{ 0b11111111, 0b11111111 }, .E = .{ 0b11111111, 0b11111111 } },
        .{ .OP = cpu.LD_HL_D16, .IMM = .{ 0b00000000, 0b00000000 }, .H = .{ 0b00000000, 0b00000000 }, .L = .{ 0b00000000, 0b00000000 } },
        .{ .OP = cpu.LD_HL_D16, .IMM = .{ 0b00000001, 0b00000001 }, .H = .{ 0b00000001, 0b00000001 }, .L = .{ 0b00000001, 0b00000001 } },
        .{ .OP = cpu.LD_HL_D16, .IMM = .{ 0b00110100, 0b00010010 }, .H = .{ 0b00110100, 0b00110100 }, .L = .{ 0b00010010, 0b00010010 } },
        .{ .OP = cpu.LD_HL_D16, .IMM = .{ 0b10101010, 0b01010101 }, .H = .{ 0b10101010, 0b10101010 }, .L = .{ 0b01010101, 0b01010101 } },
        .{ .OP = cpu.LD_HL_D16, .IMM = .{ 0b11001100, 0b00110011 }, .H = .{ 0b11001100, 0b11001100 }, .L = .{ 0b00110011, 0b00110011 } },
        .{ .OP = cpu.LD_HL_D16, .IMM = .{ 0b11111111, 0b11111111 }, .H = .{ 0b11111111, 0b11111111 }, .L = .{ 0b11111111, 0b11111111 } },
        .{ .OP = cpu.LD_SP_D16, .IMM = .{ 0b00000001, 0b00000001 }, .S = .{ 0b00000001, 0b00000001 }, .P = .{ 0b00000001, 0b00000001 } },
        .{ .OP = cpu.LD_SP_D16, .IMM = .{ 0b00110100, 0b00010010 }, .S = .{ 0b00110100, 0b00110100 }, .P = .{ 0b00010010, 0b00010010 } },
        .{ .OP = cpu.LD_SP_D16, .IMM = .{ 0b01000010, 0b01101001 }, .S = .{ 0b01000010, 0b01000010 }, .P = .{ 0b01101001, 0b01101001 } },
        .{ .OP = cpu.LD_SP_D16, .IMM = .{ 0b01010101, 0b10101010 }, .S = .{ 0b01010101, 0b01010101 }, .P = .{ 0b10101010, 0b10101010 } },
        .{ .OP = cpu.LD_SP_D16, .IMM = .{ 0b01111111, 0b11111111 }, .S = .{ 0b01111111, 0b01111111 }, .P = .{ 0b11111111, 0b11111111 } },
        .{ .OP = cpu.LD_SP_D16, .IMM = .{ 0b10000000, 0b00000000 }, .S = .{ 0b10000000, 0b10000000 }, .P = .{ 0b00000000, 0b00000000 } },
        .{ .OP = cpu.LD_SP_D16, .IMM = .{ 0b10101010, 0b01010101 }, .S = .{ 0b10101010, 0b10101010 }, .P = .{ 0b01010101, 0b01010101 } },
        .{ .OP = cpu.LD_SP_D16, .IMM = .{ 0b11001100, 0b00110011 }, .S = .{ 0b11001100, 0b11001100 }, .P = .{ 0b00110011, 0b00110011 } },
        .{ .OP = cpu.LD_SP_D16, .IMM = .{ 0b11110000, 0b00001111 }, .S = .{ 0b11110000, 0b11110000 }, .P = .{ 0b00001111, 0b00001111 } },
        .{ .OP = cpu.LD_SP_D16, .IMM = .{ 0b11111111, 0b11111111 }, .S = .{ 0b11111111, 0b11111111 }, .P = .{ 0b11111111, 0b11111111 } },
        // INC_XX
        .{ .OP = cpu.INC_BC, .B = .{ 10, 10 }, .C = .{ 10, 11 } },
        .{ .OP = cpu.INC_BC, .B = .{ 0, 0 }, .C = .{ 0, 1 } },
        .{ .OP = cpu.INC_BC, .B = .{ 0, 0 }, .C = .{ 1, 2 } },
        .{ .OP = cpu.INC_BC, .B = .{ 0, 0 }, .C = .{ 254, 255 } },
        .{ .OP = cpu.INC_BC, .B = .{ 0, 1 }, .C = .{ 255, 0 } },
        .{ .OP = cpu.INC_BC, .B = .{ 1, 1 }, .C = .{ 0, 1 } },
        .{ .OP = cpu.INC_BC, .B = .{ 1, 2 }, .C = .{ 255, 0 } },
        .{ .OP = cpu.INC_BC, .B = .{ 15, 15 }, .C = .{ 15, 16 } },
        .{ .OP = cpu.INC_BC, .B = .{ 15, 16 }, .C = .{ 255, 0 } },
        .{ .OP = cpu.INC_BC, .B = .{ 50, 50 }, .C = .{ 100, 101 } },
        .{ .OP = cpu.INC_BC, .B = .{ 100, 101 }, .C = .{ 255, 0 } },
        .{ .OP = cpu.INC_BC, .B = .{ 128, 128 }, .C = .{ 128, 129 } },
        .{ .OP = cpu.INC_BC, .B = .{ 200, 200 }, .C = .{ 200, 201 } },
        .{ .OP = cpu.INC_BC, .B = .{ 254, 254 }, .C = .{ 254, 255 } },
        .{ .OP = cpu.INC_BC, .B = .{ 254, 255 }, .C = .{ 255, 0 } },
        .{ .OP = cpu.INC_BC, .B = .{ 255, 255 }, .C = .{ 254, 255 } },
        .{ .OP = cpu.INC_BC, .B = .{ 255, 0 }, .C = .{ 255, 0 } },
        .{ .OP = cpu.INC_BC, .B = .{ 10, 10 }, .C = .{ 10, 11 } },
        .{ .OP = cpu.INC_DE, .D = .{ 10, 10 }, .E = .{ 10, 11 } },
        .{ .OP = cpu.INC_DE, .D = .{ 0, 0 }, .E = .{ 0, 1 } },
        .{ .OP = cpu.INC_DE, .D = .{ 0, 0 }, .E = .{ 1, 2 } },
        .{ .OP = cpu.INC_DE, .D = .{ 0, 0 }, .E = .{ 254, 255 } },
        .{ .OP = cpu.INC_DE, .D = .{ 0, 1 }, .E = .{ 255, 0 } },
        .{ .OP = cpu.INC_DE, .D = .{ 1, 1 }, .E = .{ 0, 1 } },
        .{ .OP = cpu.INC_DE, .D = .{ 1, 2 }, .E = .{ 255, 0 } },
        .{ .OP = cpu.INC_DE, .D = .{ 15, 15 }, .E = .{ 15, 16 } },
        .{ .OP = cpu.INC_DE, .D = .{ 15, 16 }, .E = .{ 255, 0 } },
        .{ .OP = cpu.INC_DE, .D = .{ 50, 50 }, .E = .{ 100, 101 } },
        .{ .OP = cpu.INC_DE, .D = .{ 100, 101 }, .E = .{ 255, 0 } },
        .{ .OP = cpu.INC_DE, .D = .{ 128, 128 }, .E = .{ 128, 129 } },
        .{ .OP = cpu.INC_DE, .D = .{ 200, 200 }, .E = .{ 200, 201 } },
        .{ .OP = cpu.INC_DE, .D = .{ 254, 254 }, .E = .{ 254, 255 } },
        .{ .OP = cpu.INC_DE, .D = .{ 254, 255 }, .E = .{ 255, 0 } },
        .{ .OP = cpu.INC_DE, .D = .{ 255, 255 }, .E = .{ 254, 255 } },
        .{ .OP = cpu.INC_DE, .D = .{ 255, 0 }, .E = .{ 255, 0 } },
        .{ .OP = cpu.INC_DE, .D = .{ 10, 10 }, .E = .{ 10, 11 } },
        .{ .OP = cpu.INC_HL, .H = .{ 10, 10 }, .L = .{ 10, 11 } },
        .{ .OP = cpu.INC_HL, .H = .{ 0, 0 }, .L = .{ 0, 1 } },
        .{ .OP = cpu.INC_HL, .H = .{ 0, 0 }, .L = .{ 1, 2 } },
        .{ .OP = cpu.INC_HL, .H = .{ 0, 0 }, .L = .{ 254, 255 } },
        .{ .OP = cpu.INC_HL, .H = .{ 0, 1 }, .L = .{ 255, 0 } },
        .{ .OP = cpu.INC_HL, .H = .{ 1, 1 }, .L = .{ 0, 1 } },
        .{ .OP = cpu.INC_HL, .H = .{ 1, 2 }, .L = .{ 255, 0 } },
        .{ .OP = cpu.INC_HL, .H = .{ 15, 15 }, .L = .{ 15, 16 } },
        .{ .OP = cpu.INC_HL, .H = .{ 15, 16 }, .L = .{ 255, 0 } },
        .{ .OP = cpu.INC_HL, .H = .{ 50, 50 }, .L = .{ 100, 101 } },
        .{ .OP = cpu.INC_HL, .H = .{ 100, 101 }, .L = .{ 255, 0 } },
        .{ .OP = cpu.INC_HL, .H = .{ 128, 128 }, .L = .{ 128, 129 } },
        .{ .OP = cpu.INC_HL, .H = .{ 200, 200 }, .L = .{ 200, 201 } },
        .{ .OP = cpu.INC_HL, .H = .{ 254, 254 }, .L = .{ 254, 255 } },
        .{ .OP = cpu.INC_HL, .H = .{ 254, 255 }, .L = .{ 255, 0 } },
        .{ .OP = cpu.INC_HL, .H = .{ 255, 255 }, .L = .{ 254, 255 } },
        .{ .OP = cpu.INC_HL, .H = .{ 255, 0 }, .L = .{ 255, 0 } },
        .{ .OP = cpu.INC_HL, .H = .{ 10, 10 }, .L = .{ 10, 11 } },
        .{ .OP = cpu.INC_SP, .S = .{ 10, 10 }, .P = .{ 11, 12 } },
        .{ .OP = cpu.INC_SP, .S = .{ 0, 0 }, .P = .{ 1, 2 } },
        .{ .OP = cpu.INC_SP, .S = .{ 0, 0 }, .P = .{ 2, 3 } },
        .{ .OP = cpu.INC_SP, .S = .{ 0, 0 }, .P = .{ 0, 1 } },
        .{ .OP = cpu.INC_SP, .S = .{ 1, 1 }, .P = .{ 0, 1 } },
        .{ .OP = cpu.INC_SP, .S = .{ 1, 1 }, .P = .{ 1, 2 } },
        .{ .OP = cpu.INC_SP, .S = .{ 2, 2 }, .P = .{ 0, 1 } },
        .{ .OP = cpu.INC_SP, .S = .{ 15, 15 }, .P = .{ 16, 17 } },
        .{ .OP = cpu.INC_SP, .S = .{ 16, 16 }, .P = .{ 0, 1 } },
        .{ .OP = cpu.INC_SP, .S = .{ 50, 50 }, .P = .{ 101, 102 } },
        .{ .OP = cpu.INC_SP, .S = .{ 101, 101 }, .P = .{ 0, 1 } },
        .{ .OP = cpu.INC_SP, .S = .{ 128, 128 }, .P = .{ 129, 130 } },
        .{ .OP = cpu.INC_SP, .S = .{ 200, 200 }, .P = .{ 201, 202 } },
        .{ .OP = cpu.INC_SP, .S = .{ 255, 255 }, .P = .{ 0, 1 } },
        .{ .OP = cpu.INC_SP, .S = .{ 255, 255 }, .P = .{ 0, 1 } },
        .{ .OP = cpu.INC_SP, .S = .{ 0, 0 }, .P = .{ 0, 1 } },
        .{ .OP = cpu.INC_SP, .S = .{ 0, 0 }, .P = .{ 0, 1 } },
        .{ .OP = cpu.INC_SP, .S = .{ 10, 10 }, .P = .{ 11, 12 } },
    };

    // run test cases
    for (test_cases, 0..) |case, idx| {
        // PREP
        var c = cpu.CPU.init();
        c.clean_reg();

        c.REG[@intCast(cpu.A)] = @intCast(case.A[INIT]);
        c.REG[@intCast(cpu.B)] = @intCast(case.B[INIT]);
        c.REG[@intCast(cpu.C)] = @intCast(case.C[INIT]);
        c.REG[@intCast(cpu.D)] = @intCast(case.D[INIT]);
        c.REG[@intCast(cpu.E)] = @intCast(case.E[INIT]);
        c.REG[@intCast(cpu.H)] = @intCast(case.H[INIT]);
        c.REG[@intCast(cpu.L)] = @intCast(case.L[INIT]);
        c.REG[@intCast(cpu.CF)] = @intCast(case.CF[INIT]);
        c.REG[@intCast(cpu.HF)] = @intCast(case.HF[INIT]);
        c.REG[@intCast(cpu.NF)] = @intCast(case.NF[INIT]);
        c.REG[@intCast(cpu.ZF)] = @intCast(case.ZF[INIT]);
        c.REG[@intCast(cpu.S)] = @intCast(case.S[INIT]);
        c.REG[@intCast(cpu.P)] = @intCast(case.P[INIT]);
        c.REG[@intCast(case.MEM[ADDRESS] + cpu.SREG_SIZE)] = @intCast(case.MEM[VAL]);

        // WHEN
        std.debug.print("case: {d}, op 0x{X} ", .{ idx, case.OP });
        c.run_ins(.{ case.OP, case.IMM[IMM0], case.IMM[IMM1] });

        // THEN
        try std.testing.expect(c.REG[@intCast(cpu.A)] == case.A[EXP]);
        try std.testing.expect(c.REG[@intCast(cpu.B)] == case.B[EXP]);
        try std.testing.expect(c.REG[@intCast(cpu.C)] == case.C[EXP]);
        try std.testing.expect(c.REG[@intCast(cpu.D)] == case.D[EXP]);
        try std.testing.expect(c.REG[@intCast(cpu.E)] == case.E[EXP]);
        try std.testing.expect(c.REG[@intCast(cpu.H)] == case.H[EXP]);
        try std.testing.expect(c.REG[@intCast(cpu.L)] == case.L[EXP]);
        try std.testing.expect(c.REG[@intCast(cpu.CF)] == case.CF[EXP]);
        try std.testing.expect(c.REG[@intCast(cpu.HF)] == case.HF[EXP]);
        try std.testing.expect(c.REG[@intCast(cpu.NF)] == case.NF[EXP]);
        try std.testing.expect(c.REG[@intCast(cpu.ZF)] == case.ZF[EXP]);
        try std.testing.expect(c.REG[@intCast(cpu.S)] == case.S[EXP]);
        try std.testing.expect(c.REG[@intCast(cpu.P)] == case.P[EXP]);

        c.REG[@intCast(case.MEM[0] + cpu.SREG_SIZE)] = @intCast(case.MEM[1]);
        c.REG[@intCast(case.EXP_MEM[0] + cpu.SREG_SIZE)] = @intCast(case.EXP_MEM[1]);

        std.debug.print("PASSED\n", .{});
    }
}
